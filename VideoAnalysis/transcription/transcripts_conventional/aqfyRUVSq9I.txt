aqfyRUVSq9I
https://www.youtube.com/watch?v=aqfyRUVSq9I
Unknown Category
Hi guys, thanks for joining me. So this time we're going to build this. A really gnarly sounding active filter that only takes one chip, one capacitor and a handful of resistors. So stay tuned. Hi folks, welcome back. So how are we going to do that? Well in previous videos we've taken resistors and capacitors and used them together to make filters. Now we're going to take resistors and capacitors again, only this time we're going to use them with active circuitry which is going to boost the gain of the signal after it's been filtered. How we're going to do that is with a little circuit called an op-amp. And an op-amp, or an operational amplifier, is a type of configurable high-gain amplifier where you can set clever feedback networks with simple components like resistors and capacitors that can change the gain of the circuit depending on what's going on. We're going to start with the most basic op-amp circuit that you can get. So let me just explain this very quickly. This is an op-amp circuit symbol. So we've got two inputs, we call this the non-inverting input, this is the inverting input, and this is the output. Okay, so this is called a follower. And the really important thing about this, that's the number one rule that you need to remember, when we have negative feedback, which is when the output is connected back to the inverting input, that the op-amp will then do whatever it can to try and make these two inputs equal. Okay, so why don't I put a input in here, and we'll have a look at what we're going to see in the output. We'll put a sine wave in. Rule number one, do we have negative feedback? Yes, we do. Okay, so it's going to try and make these two inputs equal. If we've got positive feedback, that makes things a little bit more complicated, and we'll do that in further videos. But for now, only looking at negative feedback will get us a long way. So the output will do whatever it can to make these two inputs equal. And what that means is, let's say this is one volt at the top and at the bottom. So this is zero volts. That's why we call this a follower, because if you follow, if you think the circuit through, if this is one volt, this wants to be one volt, there's no circuitry here, so the output just needs to be one volt. So minus one volt, if this is minus one volt here, what does this one want to be? It's going to be minus one volt. So very easy to see that the output just looks exactly the same as the input. Easy peasy. So this is called a follower, and this is essentially what we can think of as a buffer. Okay, so that's all well and good. I'm sure you can see how that's useful, but it doesn't really do anything. You just get the outputs the same as the input. How do we get up-amp circuits that do stuff? Well, let's have a look what happens when we put some stuff in this feedback path. Okay, so by putting two resistors in the feedback circuit, I think you can probably imagine that I've changed how this circuit is going to work quite a lot. This is now a non-inverting amplifier. And we can imagine that the output is still going to look something like this input. Obviously I've already given it away and told you that it's non-inverting. So how do we tell what the relationship is between the output and the input? Well, we can see down here that what we've essentially done is we've made a voltage divider from the output down to ground. I just put output, that's this point here, and this point here is this point here. So the output of our voltage divider, this goes to our inverting input. Then we can see that the ratio of these two resistors is going to set the voltage at this point, which is then going to be what's fed back into here. So the output is going to do what it can to make sure that the voltage at this point here is the same as this point here. Remember our golden rule from before. And so what it needs to do is drop enough voltage across this whole voltage divider to make this point the same as this point. Input is at one volt. Let's say this is 100 kilo ohms, this is R2, and let's say that R1 is one kilo ohm. To cut a long story short, this circuit has to output 101 volts at the output to make this part here one volt, because there's a 100 to one ratio here, so there's going to be a hundred times more voltage dropped across this one than this one, so we need 101 to get that equal split. How that's represented in terms of gain is we say that this circuit has a gain, this configuration always has a gain of 1 plus R2 over R1. So if this was 100k, this was 1k, the k's cancel out, so we've essentially got 100 over 1, which is 100 plus 1, 101. Okay, so if this were 10k, then this output would have to be 11 volts to get 1 volt here. And so we can see that, let's just leave it like this, that we're going to get an output that is much bigger. We're going to have an output that's 10 times bigger than our input. That's how you make a non-inverting amplifier. So there's one more variation that I want to show you before we go on to building our active filter. Okay, so this is a slightly more interesting configuration. Now this time we've still got negative feedback, see, so we can still use our first golden rule, but we're applying the input signal to the same input that we're feeding back. So our feedback is going to kind of be mixed with our input signal, which is going to be giving us some very interesting results. The second really interesting thing, now we've got this non-inverting input connected to ground. So what does that do with our circuit? So if we now think about this point here, if this point here is connected to ground, we've got negative feedback, so remember our rule number one, the op-amp will now try and make these two inputs the same. So that means that it's going to try and make this input ground. This is a really special part of op-amp analysis, which is that this point is now called virtual ground, which means that this point will act for all intents and purposes, like a second ground. If we have our input here and ground here, then our entire input signal is across this resistor. That makes it really easy to analyze, doesn't it? Because now we know, let's say this is one volt peak to peak again, so we've got one milliamp through this resistor. So now we need our second magical rule that no current flows in or out of these terminals. So we've got this one milliamp current that flows this way. So what happens to it? Well, I've just told you that it can't go in here, so we know it has to go this way. And now if we've got current flowing this way, we've got a positive voltage drop in this direction, and one milliamp times 10k is 10 volts. So now we've got, as far as the output is concerned, so if this point is ground, and there's then a 10 volts voltage drop across this resistor, then that means that this point is 10 volts lower than this point. Now this is ground, so that's zero, so this must be minus 10 volts. And then when this is negative, this is minus 1 volts, well this all gets flipped around. This is minus 1 milliamps now. So now remember this is ground, we've got minus 10 volts, so this place must be plus 10. So this time the gain is minus R2 over R1. This is R2, this is R1, and this minus just shows us, just telling us mathematically that it's inverted. So this inverting amplifier configuration is the one that we're going to use to make our active filter. So we've taken the inverting op-amp configuration from before, and we just put a capacitor in parallel with the feedback resistor. So how is that going to affect how this circuit works? In a sentence, a capacitor can be viewed as a resistor that's able to change its resistance depending on the frequency of the signal across it. Watch my circuits one-on-one video if you want the whole story, but essentially what's going to happen is that this capacitor is going to look like a very big or very small resistance depending on what frequency we're looking at. So how is that going to change the behavior of the circuit? Well let's have a look at this circuit in terms of the voltages instead of before how I looked at it with the currents. So for a second let's pretend that capacitor wasn't there, and let's see what happens when you apply one volt at the input. If we assume that the output begins at zero volts, what we're doing is we're applying one volt to a voltage divider that looks like this. So let's say that the output is ground, zero volts, so we've got one volt across 1k and then 10k, so we're going to see about 0.9 volts at this inverting input. The op-amp now is going to try and make these two inputs equal because this inputs at ground remember. This is exactly the same as what we've just done. So now what does the output of the op-amp have to do to make this point zero? Well the op-amp has to put minus 0.9 volts here, because if there's 0.9 volts here the op-amp wants to kind of oppose that. Okay so we know we want about minus 0.9 volts at this point because then minus 0.9 plus 0.9 will make this point zero. So what does the output have to do in order to do that? And to get about minus 0.9 volts here, the output needs to push minus 10 volts this way. So either we've got a current coming this way that drops voltage here and voltage here, or we can think about this as a kind of balancing act of these two resistances and the output opposing the input to make this point zero. If we think of it in terms of those voltages and we put this capacitor back in, what we're essentially saying is that when at very low frequencies, when the capacitor looks like essentially an open circuit, you've got that behaviour that we were just talking about. This just acts like an inverting amplifier. But when we have the capacitor in and we think about the high frequencies, well that short circuits this, and the op-amp output can bypass this resistor and oppose the input with almost no effort. So what we're saying is that at high frequencies, the output can bypass this resistor because this capacitor looks like a short circuit at high frequencies, and at low frequencies it behaves like an ordinary amplifier. So we essentially get discrimination between low frequencies and high frequencies by simply just adding a capacitor in here. So in this context we're just thinking of this capacitor as a frequency dependent resistor, and it's the frequency at which this resistance becomes comparable to this resistance that is going to set the point at which it starts to filter. And we call that point the 3dB point, and again I'm not going to go into it now because I've done my circuits 101 video where I go through all of this stuff. The point I'm trying to make is that if you vary this resistor, you can change the point at which those two resistances become comparable, and that sets the threshold for the filter. Now if you're eagle-eyed you would have seen there's a huge problem with that, because if we change this resistance at low frequencies, remember, let's just ignore this because it's an open circuit, now we've got a inverting amplifier, but it's these two resistances that sets the gain. So we're simultaneously changing the cutoff frequency and the gain at the same time, and we don't want to do that. So all we're going to do is replace these two resistances with a linked stereo potentiometer, which is basically a potentiometer where you turn one dial and it wipes two separate potentiometers at the same time. So you can always keep these two resistances to be exactly equal, so the gain is always one. Okay, so now the last consideration we have to make, this is setting our midpoint. Usually you see an op-amp like this, but this is plus V and this is minus V if we have a split supply, but we've been using batteries. So this is going to be ground, the negative supply is going to be ground, this is going to be 9 volts. So if we connect a disk to ground as well, our output circuit, our output signal sorry, would look like this. Because we can't go below ground, we need to set this point here to 4.5 volts, we want our output signal to look like this, to be centred around the centre so there's no clipping at the top or at the bottom. There's a couple of ways we could do this. Okay, so we could set up a circuit like this if we wanted to. This is our low pass filter that we just looked at, remember this is a stereo potentiometer here, and then this is just a unity gain inverting amplifier, just as a buffer, and then you take the output out here. We could also just do what we've been doing all along, which is to take advantage of our CMOS chips ability to do all this stuff for us. This CD4069UB is an inverting amplifier with the midway point threshold set internally to the chip. Take rid of this stuff, get rid of this stuff. So these two inputs obviously still exist, but they're internal to the chip and they're setting that threshold for us. So with one, two, three, four components and one chip, we can make ourselves a stable active filter. Right, hello folks. What we're going to do now is we're going to build the circuit out. A bit of a 4106 oscillator as a sound source, you can use any sound source you want. Okay, so now we're going to take this and we're going to put it into our 4069, but we're going to do it via this stereo potentiometer. So we're going to take one output of the 4106, and I'm going to feed it to one leg of the stereo potentiometer. So this is a potentiometer with two potentiometers with only one wiper, and I'm putting it on either side of the track like this so they're electrically isolated from one another. And then I'm going to use them as two separate potentiometers. So I'm using this one as my input potentiometer. It goes through this right hand side first, and then to the 4069. And it's also serving as my feedback resistor. Okay, so that should be a unity gain inverting amplifier now. And as I vary the potentiometer, the gain shouldn't change. Good. Okay, so now what I'm going to do is I'm going to put a capacitor, a small capacitor. I'm going to use a 0.033 microfarad capacitor in parallel with this. So one leg at the output of the op-amp and the other leg at the input. That's the input signal where it's just an ordinary square wave, you know, it looks exactly the same as the input. And then as we filter it, it becomes more like a triangle wave. Those high frequencies are filtered out. You can see on the scope that the amplitude isn't changing. Okay, and then finally, I've just added another inverting buffer with just 100k, which is this resistor here, and then 100k feeding back. So that's just buffered the output. So that we can't load it down. Okay, so that's it for this one guys. Thanks for joining me today. We looked over three super simple op-amp circuits. We learned how to analyze op-amp circuits in general, and we built ourselves this awesome sounding active filter. Thanks for watching. Make sure you like, share, subscribe, do all that stuff. Ring the bell. Find me on social media on Facebook, Twitter, Instagram, watch more of my videos here, some over here, and I'll see you all next time. Take care. Amen.
PlKeFj5teo4
https://www.youtube.com/watch?v=PlKeFj5teo4
Unknown Category
There's two very critical pieces of hardware on a drone that allows it to fly autonomously. Today we're going to cover what the difference is between a flight controller and a flight computer in the context of an autonomous drone, and why you might want to keep them separate for your particular project. There's two key levels of control that are going on behind the scenes in an autonomous drone. Of course, much more complex systems have many levels with specific functionality, but I want to focus on the bare minimum in order to have a drone do something useful entirely on its own. The interloop controller is what stabilizes the vehicle either at a specified angle or vehicle body rate. Drones are inherently unstable. They require active stabilization to the motors to keep it in the air at all. Without this, even the most skilled of pilots could not keep them in the air for more than a few seconds. The outerloop controller can be thought of as a simulated pilot that is generating pilot commands. It does this in response to various sensor data used to figure out where the drone is in space to get it from point A to B without crashing. We call the board that handles interloop control the flight controller. This is the heart of the drone that allows a pilot to talk to it with a requested vehicle state and output stabilized commands to the motors to achieve that state. A flight computer is what is used to conduct all outerloop control and requests a vehicle state from the flight controller just like a pilot does. The flight computer is the decision-making brain of a drone that makes this request as it is informed by various onboard sensor data combined with what specific task it should be carrying out. For example, GPS data tells the flight computer where it is in space. If the mission is to travel from point A to B, then the flight computer must generate the required commands to the flight controller to navigate the drone accordingly. Let's take a look at what processes are occurring in the flight controller or interloop. First, accelerometer and gyro data is pulled from the flight controller's inertial measurement unit. This data must be processed with some sort of filter in order to estimate the drone's orientation, as individual accelerometer or gyro data cannot do this alone. The simplest and least accurate filtering technique is called a complementary filter. The most accurate filter may be a Kalman-type filter, though it is very computationally costly. A magic filter is a good compromise between the other two. Next, the flight controller needs to know the desired vehicle state, or setpoint, commanded by the pilot or flight computer. This setpoint is used to compute the error in the drone's current orientation from where it is desired to be. A PID controller is used to generate stabilized signals based on this error. These signals for each vehicle axis of rotation can be applied to the drone's motors according to the dynamic configuration in the control mixer. For example, to stabilize pitch, the forward motors and rear motors must receive opposite stabilized signals. We then write these signals out to the motors, which in turn generates a vehicle response. This response is again measured by the IMU, and we have created a feedback loop. Typically on a flight controller, this process runs at 1000 or more cycles per second. So now that we can see all of the challenges that must be solved in order to complete this loop, let's see what this looks like in action. The previous flight controller loop diagram can be supplemented with additional filtering, control techniques, or safety measures. With a properly designed and tuned controller, a very fast and accurate response is possible. Next, we will look at the operation of the flight computer. This is a very broad overview of what could be happening on board, though the specifics vary based on the application. Because there is so much going on, it is not necessarily a loop either, but a continuously updated stream of input and output data. The flight computer needs an interrupt handler to process sensor data as it becomes available. The popular system used is ROS, which allows for easy access across multiple sensors, computations, and outputs. An autonomous drone might have a combination of cameras, LIDAR, or GPS on board. This sensor data is used to estimate the drone's position in space from information about its surroundings or movement, which is known as odometry. Once the drone knows where it is, a mission planner can be used to decide where to go next. A typical mission planner might look something like this. It must first decide what the current task is, for example, flying through a window. Next, the mission planner may request that the drone search for the target by either flying forward or turning around. Then once the target is identified, it must converge on it to ensure that it has actually found the target and not something else. Finally, the desired maneuver for that target can be executed. Once this is complete, the mission planner decides what to do next. The mission planner conducts its operations and in the process requests that the drone moves around. A controller is used to generate requested vehicle state set points based on where the mission planner wants the drone to be and where the odometry thinks the drone is. These requests are then sent to the flight controller at a rate of about 50 to 100 times per second. Here we can see that full and complicated process in action in a simple autonomous landing demo. The mission planner's goal here is to land on the target. It first performs a forward search and then once the target is identified by a downward-facing camera, requests that the vehicle begins to descend as the detection algorithm converges on the target. You might rightfully be asking, why not just do everything on the flight computer? My answer to that is you certainly can, and many companies such as DJI do that with their custom boards to save power and weight, but if you are assembling your own system, you may run into some problems. First, the flight computer speed is not guaranteed constant, which is a problem for stabilizing a vehicle which requires constant, high-speed operation to stay in the air. A flight computer's CPU may become overloaded if excessive computations are being demanded from computer vision algorithms, which slow down the whole system or even crash it entirely. So generally speaking, it is best to have a dedicated single-task microcontroller for stabilization that guarantees the vehicle will be stabilized regardless of the health of the flight computer. In the event that the flight computer encounters an error, you can always switch back to the pilot transmitter to safely land the vehicle. So to answer our original question, the flight controller is a dedicated board to simply stabilize the vehicle, whereas the flight computer performs all the onboard decision-making and sensing, much like a pilot. Both are very important for safe and reliable autonomous drone operation. This was a very broad overview of some of the things going on inside an autonomous drone, and is by no means comprehensive. I hope you've learned something, and you now have a better understanding of some of the topics that need to be addressed to create a fully autonomous drone. If you're interested in some more of the nitty-gritty, check out my other video on a fully autonomous drone completing an obstacle course, and how we did it.
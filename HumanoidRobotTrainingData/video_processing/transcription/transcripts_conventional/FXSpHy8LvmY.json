{"video_id": "FXSpHy8LvmY", "url": "https://www.youtube.com/watch?v=FXSpHy8LvmY", "title": "FXSpHy8LvmY", "category": "Unknown Category", "fps": null, "segments": [{"start": 0.4, "end": 4.0, "text": "In this video, we're going to talk about a way to develop a feedback controller for"}, {"start": 4.0, "end": 6.84, "text": "a model that's represented using state space equations."}, {"start": 6.84, "end": 12.32, "text": "And we're going to do that with a method called pole placement, or full state feedback."}, {"start": 12.32, "end": 17.02, "text": "Now my experience is that pole placement itself isn't used extensively in industry."}, {"start": 17.02, "end": 21.76, "text": "You might find that you're using other methods like LQR or H infinity more often."}, {"start": 21.76, "end": 25.38, "text": "However, pole placement is worth spending some time on because it will give you a better"}, {"start": 25.38, "end": 30.34, "text": "understanding of the general approach to feedback control using state space equations."}, {"start": 30.34, "end": 33.58, "text": "And it's a stepping stone to getting to those other methods."}, {"start": 33.58, "end": 35.04, "text": "So I hope you stick around."}, {"start": 35.04, "end": 39.58, "text": "I'm Brian, and welcome to a MATLAB Tech Talk."}, {"start": 39.58, "end": 44.18, "text": "To start off, we have a plant with inputs U and outputs Y."}, {"start": 44.18, "end": 49.14, "text": "And the goal is to develop a feedback control system that drives the output to some desired"}, {"start": 49.14, "end": 50.14, "text": "value."}, {"start": 50.14, "end": 54.46, "text": "A way you might be familiar with doing this is to compare the output to a reference signal"}, {"start": 54.46, "end": 56.620000000000005, "text": "to get the control error."}, {"start": 56.620000000000005, "end": 61.160000000000004, "text": "Then you can develop a controller that uses that error to generate the input signals into"}, {"start": 61.160000000000004, "end": 64.8, "text": "the plant with the goal of driving the error to zero."}, {"start": 64.8, "end": 69.02, "text": "This is the structure of the feedback control system that you would see if you were developing,"}, {"start": 69.02, "end": 71.84, "text": "say, a PID controller."}, {"start": 71.84, "end": 76.14, "text": "But for pole placement, we're going to approach this problem in a different way."}, {"start": 76.14, "end": 80.92, "text": "Rather than feedback the output Y, we're going to feedback the value of every state variable"}, {"start": 80.92, "end": 81.92, "text": "in our state vector."}, {"start": 81.92, "end": 85.58, "text": "Now we're going to claim that we know the value of every state, even though it's not"}, {"start": 85.58, "end": 87.76, "text": "necessarily part of the output Y."}, {"start": 87.76, "end": 89.76, "text": "And we'll get to that in a bit."}, {"start": 89.76, "end": 93.64, "text": "But for now, assume we have access to all of these values."}, {"start": 93.64, "end": 97.92, "text": "We then take the state vector and multiply it by a matrix that is made up of a bunch of"}, {"start": 97.92, "end": 99.84, "text": "different gain values."}, {"start": 99.84, "end": 103.72, "text": "And the result is subtracted from a scaled reference signal."}, {"start": 103.72, "end": 108.08, "text": "And this result is fed directly into our plant as the input."}, {"start": 108.08, "end": 113.24, "text": "Now, you'll notice that there isn't a block here labeled controller, like we have in the"}, {"start": 113.24, "end": 115.16, "text": "top block diagram."}, {"start": 115.16, "end": 119.08, "text": "In this feedback structure, this whole section is the controller."}, {"start": 119.08, "end": 124.62, "text": "And pole placement is a method by which we can calculate the proper gain matrix to guarantee"}, {"start": 124.62, "end": 126.58, "text": "system stability."}, {"start": 126.58, "end": 131.07999999999998, "text": "And the scaling term on the reference is used to ensure that steady state error performance"}, {"start": 131.07999999999998, "end": 132.07999999999998, "text": "is acceptable."}, {"start": 132.08, "end": 135.82000000000002, "text": "I'll cover both of these in this video."}, {"start": 135.82000000000002, "end": 138.26000000000002, "text": "But first we need some background information."}, {"start": 138.26000000000002, "end": 142.96, "text": "In the last video we introduced the state equation x dot equals ax plus bu."}, {"start": 142.96, "end": 148.24, "text": "And we showed that the dynamics of a linear system are captured in this first part, ax."}, {"start": 148.24, "end": 152.9, "text": "The second part is how the system responds to inputs, but how the energy in the system"}, {"start": 152.9, "end": 156.84, "text": "is stored and moves is captured by the ax term."}, {"start": 156.84, "end": 160.58, "text": "So, you might expect that there is something special about the A matrix when it comes to"}, {"start": 160.58, "end": 162.36, "text": "controller design."}, {"start": 162.36, "end": 163.92000000000002, "text": "And there is."}, {"start": 163.92000000000002, "end": 168.08, "text": "Any feedback controller has to modify the A matrix in order to change the dynamics of"}, {"start": 168.08, "end": 169.2, "text": "the system."}, {"start": 169.2, "end": 172.92000000000002, "text": "And this is especially true when it comes to stability."}, {"start": 172.92000000000002, "end": 176.68, "text": "The eigenvalues of the A matrix are the poles of the system."}, {"start": 176.68, "end": 180.6, "text": "And the location of the poles dictate stability of a linear system."}, {"start": 180.6, "end": 183.68, "text": "And that's the key to pole placement."}, {"start": 183.68, "end": 187.36, "text": "And then we can calculate the required closed loop stability by moving the poles, or the"}, {"start": 187.36, "end": 190.46, "text": "eigenvalues, of the closed loop A matrix."}, {"start": 190.46, "end": 194.96, "text": "Now I want to expand a bit more on the relationship between poles and eigenvalues and stability before"}, {"start": 194.96, "end": 199.3, "text": "we go any further, because I think it will help you understand exactly how pole placement"}, {"start": 199.3, "end": 201.3, "text": "works."}, {"start": 201.3, "end": 206.54000000000002, "text": "For this example, let's just start with an arbitrary system and focus on the dynamics,"}, {"start": 206.54000000000002, "end": 208.0, "text": "the A matrix."}, {"start": 208.0, "end": 212.5, "text": "We can rewrite this in non-matrix form so it's a little bit easier to see how the state derivatives"}, {"start": 212.5, "end": 214.46, "text": "relate to the states."}, {"start": 214.46, "end": 218.02, "text": "In general, each state can change as a function of the other states."}, {"start": 218.02, "end": 219.84, "text": "And that's the case here."}, {"start": 219.84, "end": 226.28, "text": "x.1 changes based on x2, and x.2 changes based on both x1 and x2."}, {"start": 226.28, "end": 228.36, "text": "And this is perfectly acceptable."}, {"start": 228.36, "end": 232.44, "text": "But it makes it a little hard to visualize how eigenvalues are contributing to the overall"}, {"start": 232.44, "end": 233.72, "text": "dynamics."}, {"start": 233.72, "end": 239.0, "text": "So what we can do is transform the A matrix into one that uses a different set of state"}, {"start": 239.0, "end": 241.96, "text": "variables to describe the system."}, {"start": 241.96, "end": 246.94, "text": "This transformation is accomplished using a transform matrix, whose columns are the eigenvectors"}, {"start": 246.94, "end": 248.58, "text": "of the A matrix."}, {"start": 248.58, "end": 254.24, "text": "And what we end up with after the transformation is a modified A matrix consisting of the complex"}, {"start": 254.24, "end": 258.9, "text": "eigenvalues along the diagonal and zeros everywhere else."}, {"start": 258.9, "end": 262.74, "text": "Now, these two models represent the exact same system."}, {"start": 262.74, "end": 265.52, "text": "They have the same eigenvalues and the same dynamics."}, {"start": 265.52, "end": 270.62, "text": "It's just the second one is described using a set of state variables that change independently"}, {"start": 270.62, "end": 272.34, "text": "of each other."}, {"start": 272.34, "end": 276.28, "text": "When the A matrix is written in diagonal form, it's easy to see that what we're left with"}, {"start": 276.28, "end": 281.58, "text": "is a set of first order differential equations where the derivative of each state is only affected"}, {"start": 281.58, "end": 284.47999999999996, "text": "by that state, and nothing else."}, {"start": 284.47999999999996, "end": 286.08, "text": "And here's the cool part."}, {"start": 286.08, "end": 291.21999999999997, "text": "The solution to a differential equation like this is in the form z equals a constant times"}, {"start": 291.22, "end": 298.82000000000005, "text": "e to the lambda t, where lambda is the eigenvalue for that given state variable."}, {"start": 298.82000000000005, "end": 303.18, "text": "Okay, let's dive into this equation a little bit more."}, {"start": 303.18, "end": 309.1, "text": "z in shows how the state changes over time given some initial condition, c."}, {"start": 309.1, "end": 313.32000000000005, "text": "Or another way of thinking about this is that if you initialize the state with some energy,"}, {"start": 313.32000000000005, "end": 318.94000000000005, "text": "or you add energy from an external input, this equation shows how that energy changes."}, {"start": 318.94, "end": 324.36, "text": "And by changing lambda, you can affect how the energy is dissipated, or in the case of an"}, {"start": 324.36, "end": 327.12, "text": "unstable system, how the energy grows."}, {"start": 327.12, "end": 330.84, "text": "So let's go through a few different values of lambda so you can visually see how energy"}, {"start": 330.84, "end": 335.9, "text": "changes based on the location of the eigenvalue within the complex plane."}, {"start": 335.9, "end": 342.12, "text": "If lambda is a negative real number, then this is a stable eigenvalue since the solution"}, {"start": 342.12, "end": 347.4, "text": "is e raised to a negative number, and any initial energy will dissipate over time."}, {"start": 347.4, "end": 352.68, "text": "But if it's positive, then it's unstable because the energy will just grow over time."}, {"start": 352.68, "end": 357.24, "text": "And if there's a pair of imaginary eigenvalues, then the energy in this mode will oscillate,"}, {"start": 357.24, "end": 362.02, "text": "since e raised to an imaginary number produces sines and cosines."}, {"start": 362.02, "end": 367.3, "text": "And any combination of the two, of real and imaginary numbers, will produce a combination"}, {"start": 367.3, "end": 371.88, "text": "of oscillations and exponential energy dissipation."}, {"start": 371.88, "end": 376.36, "text": "Now I know this was all very fast, but hopefully it made enough sense that now we can state the"}, {"start": 376.36, "end": 378.44, "text": "problem we're trying to solve."}, {"start": 378.44, "end": 383.64, "text": "If our plant has eigenvalues that are at undesirable locations in the complex plane, then we can use"}, {"start": 383.64, "end": 387.22, "text": "pole placement to move them somewhere else."}, {"start": 387.22, "end": 391.86, "text": "Now certainly if they're in the right half plane it's undesirable since they'd be unstable,"}, {"start": 391.86, "end": 396.28000000000003, "text": "but undesirable could also mean there's oscillations you want to get rid of, or maybe just speed"}, {"start": 396.28000000000003, "end": 401.42, "text": "up or slow down the dissipation of energy in a particular mode."}, {"start": 401.42, "end": 406.46000000000004, "text": "With that behind us, we can now get into how pole placement moves the eigenvalues."}, {"start": 406.46000000000004, "end": 409.72, "text": "Remember the structure of the controller that we drew at the beginning?"}, {"start": 409.72, "end": 418.22, "text": "Well this results in an input u equals rkr minus k times x, where rkr is the scaled reference,"}, {"start": 418.22, "end": 423.08000000000004, "text": "which again we'll get to in a bit, and kx is the state vector that we're feeding back"}, {"start": 423.08000000000004, "end": 425.40000000000003, "text": "multiplied by the gain matrix."}, {"start": 425.40000000000003, "end": 427.8, "text": "Now here's where the magic happens."}, {"start": 427.8, "end": 432.46000000000004, "text": "If we plug this control input into our state equation, we're closing the loop and we get"}, {"start": 432.46000000000004, "end": 435.86, "text": "the following state equation."}, {"start": 435.86, "end": 441.22, "text": "Notice that a and minus bk both act on the state vector, so we can combine them to get"}, {"start": 441.22, "end": 443.90000000000003, "text": "a modified a matrix."}, {"start": 443.90000000000003, "end": 447.90000000000003, "text": "This is the closed loop a matrix, and we have the ability to move the eigenvalues by"}, {"start": 447.9, "end": 450.08, "text": "choosing an appropriate k."}, {"start": 450.08, "end": 453.4, "text": "And this is easy to do by hand for simple systems."}, {"start": 453.4, "end": 457.14, "text": "Let's try an example with a second order system with a single input."}, {"start": 457.14, "end": 463.67999999999995, "text": "We can find the eigenvalues by setting the determinant of a minus lambda i to 0, and then solve for"}, {"start": 463.67999999999995, "end": 464.67999999999995, "text": "lambda."}, {"start": 464.67999999999995, "end": 468.06, "text": "And they're at minus 2 and plus 1."}, {"start": 468.06, "end": 472.96, "text": "One of the modes will blow up to infinity because of the presence of the positive real eigenvalue,"}, {"start": 472.96, "end": 476.26, "text": "and so the system as a whole is unstable."}, {"start": 476.26, "end": 480.94, "text": "Let's use pole placement to design a feedback controller that will stabilize this system"}, {"start": 480.94, "end": 484.71999999999997, "text": "by moving the unstable pole to the left half plane."}, {"start": 484.71999999999997, "end": 490.5, "text": "Our closed loop A matrix is A minus Bk, and the gain matrix k is a 1 by 2 since there's"}, {"start": 490.5, "end": 492.7, "text": "one output in two states."}, {"start": 492.7, "end": 498.9, "text": "This results in minus k1, 1 minus k2, 2, and minus 1."}, {"start": 498.9, "end": 503.58, "text": "And we can solve for the eigenvalues of ACL like we did before, and we get this characteristic"}, {"start": 503.58, "end": 508.08, "text": "equation that's a function of our two gain values."}, {"start": 508.08, "end": 512.9399999999999, "text": "Now let's say that we want our closed loop poles at minus 1 and minus 2."}, {"start": 512.9399999999999, "end": 517.6, "text": "In this way, the characteristic equation needs to be lambda squared plus 3 times lambda plus"}, {"start": 517.6, "end": 520.14, "text": "2 equals 0."}, {"start": 520.14, "end": 524.34, "text": "And at this point, it's straightforward to find the appropriate k1 and k2 that make"}, {"start": 524.34, "end": 527.24, "text": "these two equations equal."}, {"start": 527.24, "end": 530.42, "text": "We just set the coefficients equal to each other and solve."}, {"start": 530.42, "end": 535.86, "text": "And we get k1 equals 2 and k2 equals 1."}, {"start": 535.86, "end": 537.58, "text": "And that's it."}, {"start": 537.58, "end": 542.26, "text": "If we place these two gains in the state feedback path of this system, it will be stabilized"}, {"start": 542.26, "end": 546.38, "text": "with eigenvalues at minus 1 and minus 2."}, {"start": 546.38, "end": 550.54, "text": "Walking through an example by hand I think gives you a good understanding of pole placement"}, {"start": 550.54, "end": 552.22, "text": "and how it works."}, {"start": 552.22, "end": 556.66, "text": "However, the math involved starts to become overwhelming for systems that have more than"}, {"start": 556.66, "end": 558.02, "text": "two states."}, {"start": 558.02, "end": 562.62, "text": "The idea is the same, just solving the determinant becomes impractical."}, {"start": 562.62, "end": 567.34, "text": "But we can do this exact same thing in MATLAB with pretty much a single command."}, {"start": 567.34, "end": 571.52, "text": "I'll show you quickly how to use the place command in MATLAB by recreating the same system"}, {"start": 571.52, "end": 573.1999999999999, "text": "that we just did by hand."}, {"start": 573.1999999999999, "end": 578.1999999999999, "text": "I'll define the four matrices, and then create the open loop state space object."}, {"start": 578.1999999999999, "end": 582.28, "text": "I can check the eigenvalues of the open loop A matrix just to show you that there is in"}, {"start": 582.28, "end": 587.28, "text": "fact that positive eigenvalue that causes the system to be unstable."}, {"start": 587.28, "end": 588.62, "text": "And that's no good."}, {"start": 588.62, "end": 593.68, "text": "So let's move the eigenvalues of the system to minus 2 and minus 1."}, {"start": 593.68, "end": 598.52, "text": "Now solving for the gain matrix using pole placement can be done with the place command."}, {"start": 598.52, "end": 603.1999999999999, "text": "And we get gain values of 2 and 1 just like we expected."}, {"start": 603.1999999999999, "end": 607.54, "text": "Now the new closed loop A matrix is A minus BK."}, {"start": 607.54, "end": 612.54, "text": "And just to double check, this is what ACL looks like, and it does have eigenvalues at"}, {"start": 612.54, "end": 615.1999999999999, "text": "minus 1 and minus 2."}, {"start": 615.1999999999999, "end": 616.1999999999999, "text": "OK."}, {"start": 616.1999999999999, "end": 620.56, "text": "I'll create the closed loop system object, and now we can compare the step responses for"}, {"start": 620.56, "end": 621.88, "text": "both."}, {"start": 621.88, "end": 626.82, "text": "The step response of the open loop system is predictably unstable."}, {"start": 626.82, "end": 629.9, "text": "And the step response of the closed loop system looks much better."}, {"start": 629.9, "end": 632.72, "text": "However, it's not perfect."}, {"start": 632.72, "end": 638.9399999999999, "text": "Rather than rising to 1 like we would expect, the steady state output is only 0.5."}, {"start": 638.9399999999999, "end": 643.48, "text": "And this is finally where the scaling term comes in on the reference."}, {"start": 643.48, "end": 647.7, "text": "So far we've only been concerned with stability, and have paid little attention to steady state"}, {"start": 647.7, "end": 649.04, "text": "performance."}, {"start": 649.04, "end": 652.0, "text": "But even addressing this is pretty straightforward."}, {"start": 652.0, "end": 656.94, "text": "If the response of the input is only half of what you would expect, why not just double"}, {"start": 656.94, "end": 658.58, "text": "the input?"}, {"start": 658.58, "end": 660.16, "text": "And that's pretty much what we do."}, {"start": 660.16, "end": 662.26, "text": "Well, we're not just doubling it."}, {"start": 662.26, "end": 667.72, "text": "We scale the input by the inverse of the steady state value."}, {"start": 667.72, "end": 671.6800000000001, "text": "In MATLAB we can do this by inverting the DC gain of the system."}, {"start": 671.6800000000001, "end": 676.82, "text": "You can see that the DC gain is 0.5, and so the inverse is 2."}, {"start": 676.82, "end": 682.98, "text": "Now we can rebuild our closed loop system by scaling the input by kr, or by 2, and checking"}, {"start": 682.98, "end": 684.48, "text": "the step response."}, {"start": 684.48, "end": 687.78, "text": "And no surprise, its steady state value is 1."}, {"start": 687.78, "end": 690.94, "text": "And that's pretty much what there is to basic pole placement."}, {"start": 690.94, "end": 695.26, "text": "We feedback every state variable and multiply them by a gain matrix in such a way that the"}, {"start": 695.26, "end": 699.8199999999999, "text": "closed loop eigenvalues are what we want, and then we scale the input to make the steady"}, {"start": 699.8199999999999, "end": 702.48, "text": "state response what we want."}, {"start": 702.48, "end": 706.92, "text": "Of course there's more to pole placement than what I could cover in this 12 minute video."}, {"start": 706.92, "end": 710.68, "text": "And I don't want to drag this on too long, but I also don't want to leave this video"}, {"start": 710.68, "end": 714.48, "text": "without addressing a few more interesting things for you to consider."}, {"start": 714.48, "end": 719.66, "text": "So in the interest of time, let's blast through these final thoughts lightning round style."}, {"start": 719.66, "end": 720.76, "text": "Are you ready?"}, {"start": 720.76, "end": 722.38, "text": "Let's go."}, {"start": 722.38, "end": 725.0, "text": "Pole placement is like fancy root locus."}, {"start": 725.0, "end": 729.14, "text": "With root locus, you have one gain that you can adjust that can only move the poles along"}, {"start": 729.14, "end": 730.66, "text": "the locus lines."}, {"start": 730.66, "end": 734.78, "text": "But with pole placement, we have a gain matrix that gives us the ability to move the poles"}, {"start": 734.78, "end": 740.14, "text": "anywhere in the complex plane, not just along single dimensional lines."}, {"start": 740.14, "end": 744.66, "text": "A two-state pole placement controller is very similar to a PD controller."}, {"start": 744.66, "end": 749.5, "text": "With PD, you feed back the output and generate the derivative within the controller."}, {"start": 749.5, "end": 753.56, "text": "With pole placement, you are feeding back the derivative as a state, but the results are"}, {"start": 753.56, "end": 755.04, "text": "essentially the same."}, {"start": 755.04, "end": 759.12, "text": "Two gains, one for a state, and one for its derivative."}, {"start": 759.12, "end": 764.12, "text": "Okay, we can move eigenvalues around, but where should we place them?"}, {"start": 764.12, "end": 768.64, "text": "The answer to that is a much longer video, but here are some things to think about."}, {"start": 768.64, "end": 773.28, "text": "If you have a high order system, consider keeping two poles closer to the imaginary axis than"}, {"start": 773.28, "end": 777.36, "text": "the others so that the system will behave like a common second order system."}, {"start": 777.36, "end": 781.54, "text": "These are called dominant poles since they are slower and tend to dominate the response"}, {"start": 781.54, "end": 782.74, "text": "of the system."}, {"start": 782.74, "end": 788.2, "text": "Keep in mind that if you try to move a bunch of eigenvalues really far left in order to"}, {"start": 788.2, "end": 792.42, "text": "get a super fast response, you may find that you don't have the speed or authority in"}, {"start": 792.42, "end": 795.64, "text": "your actuators to generate the necessary response."}, {"start": 795.64, "end": 800.48, "text": "This is because it takes more gain, or more actuator effort, to move the eigenvalues further"}, {"start": 800.48, "end": 804.24, "text": "from their open loop starting points."}, {"start": 804.24, "end": 807.02, "text": "Full state feedback is a bit of a misnomer."}, {"start": 807.02, "end": 810.08, "text": "You are feeding back every state in your mathematical model."}, {"start": 810.08, "end": 813.8000000000001, "text": "But you don't, and can't, feed back every state in a real system."}, {"start": 813.8000000000001, "end": 819.32, "text": "For just one example, at some level all mechanical hardware is flexible, which means additional"}, {"start": 819.32, "end": 823.22, "text": "states, but you may choose to ignore those states in your model and develop your feedback"}, {"start": 823.22, "end": 825.82, "text": "controller assuming a rigid system."}, {"start": 825.82, "end": 829.34, "text": "The important part is that you feed back all critical states to your design, so that your"}, {"start": 829.34, "end": 833.24, "text": "controller will still work on the real hardware."}, {"start": 833.24, "end": 837.5200000000001, "text": "You have to have some kind of access to all of the critical states in order to feed them"}, {"start": 837.5200000000001, "end": 838.5200000000001, "text": "back."}, {"start": 838.52, "end": 842.4, "text": "The output Y might include every state, in which case you're all set."}, {"start": 842.4, "end": 846.4, "text": "However, if this isn't the case, you will either need to add more sensors to your system"}, {"start": 846.4, "end": 851.86, "text": "to measure the missing states, or use the existing outputs to estimate or observe the states you"}, {"start": 851.86, "end": 853.6, "text": "aren't measuring directly."}, {"start": 853.6, "end": 856.98, "text": "In order to observe your system, it will need to be observable."}, {"start": 856.98, "end": 860.52, "text": "And similarly, in order to control your system, it needs to be controllable."}, {"start": 860.52, "end": 890.52, "text": ""}, {"start": 890.52, "end": 894.4, "text": "I'll see you next time."}, {"start": 894.4, "end": 898.28, "text": "Thank you."}]}
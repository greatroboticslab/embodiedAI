1WYDsiYJGoQ
https://www.youtube.com/watch?v=1WYDsiYJGoQ
Unknown Category
We're going through Betaflight 4.3 Configurator, looking at every single option, telling you what it is and how to set it up so you know what to do the next time you encounter it. In today's video, we are looking at the Motors tab. If you came here for the Motors tab, then stick around. But if you somehow just stumbled across this video and you want to learn more about Betaflight Configurator, there's a playlist in the video description. You can start with video number one and go from there. Let's get on to the Motors tab. And the first option we're going to look at here is the Mixer. And the Mixer tells the Flight Controller how many motors there are, where those motors are located in space, and what direction those motors are going to be spinning. And the reason the Flight Controller needs to know this is the Flight Controller's job is to translate your stick inputs into movement of the quadcopter. So if you push the roll stick to the left, the Flight Controller knows the quadcopter needs to roll to the left, and it needs to know which motors it needs to speed up and slow down to cause the quadcopter to roll to the left. Now the most common mixer you're going to see is probably Quad X. That's what almost everybody is probably flying. But we can see that there are many different mixers that Betaflight supports. An A-tail Quad, even some fixed-wing mixers. I have to say, Betaflight's support for fixed-wing and servos is extremely poor. It just is an afterthought that hasn't received much development at all, and it can be very difficult to get servos and airplanes working with Betaflight. If you really want to build an airplane with a Flight Controller, strongly recommend using iNav instead of Betaflight. As we come down through the list, there are some layouts that have more than four motors. Here's a hexacopter mixer. Here is a octocopter mixer. There is an X8 octocopter mixer, where you have four... We have eight motors, but there are two of them are co-located with each other, and so on, and so on. There's a bunch of different mixers that you could theoretically be using. We're going to go back to the Quad X mixer that probably almost everybody is using. And the next option we're going to look at is this one, Motor Direction is Reversed. I want you to look at this diagram here and look at which direction the motors are spinning. Because one of the easiest mistakes you can make when setting up a quadcopter is to have one or more of the motors spinning the wrong direction. And a lot of times when I troubleshoot this with people, I'll say, are your motors spinning the right direction? And they'll go, yes, I double checked them. And it turns out you double checked them from memory, but like the Flight Controller doesn't agree with your memory, and so it can't fly correctly. So whenever you're checking your motor direction, always do it based on the diagram that the Flight Controller is giving you. And if we look at what this option does, motor direction is reversed, it switches the direction of all of the motors. So a lot of people would consider normal direction to be props in, they call it, and motor direction is reversed would be props out. There's pros and cons to each, and which one you want to choose is not really the topic of this video. But the key thing you need to know is that this option does not reverse the motors. So a real common mistake people make is they flip this option, they mean for the motors to be spinning props out, but the motors are actually spinning props in, and then they get confused when their quadcopter won't fly. This tells the Flight Controller what direction you intend for the motors to go. It doesn't make the motors go that direction. Now in order to make the motors spin, we have to choose an ESC and motor protocol. And the most common one that people are going to be using today is DSHOT. There are three variants of DSHOT here in Betaflight, DSHOT 150, 300, and 600. DSHOT is a digital protocol that is used to communicate between the Flight Controller and the ESC. And it essentially tells the ESC how fast that the Flight Controller wants the motor to be spinning. But DSHOT can do more than that. DSHOT can also carry digital commands to do things like reverse the motors that normally would have required you to hook up to the ESC and use a configurator or something. So DSHOT carries the throttle signal and DSHOT commands which can tell the ESC to do certain things. Now the three variants of DSHOT, DSHOT 150, 300, and 600, relate to how fast the packets are sent. DSHOT 600 is the fastest that Betaflight supports. DSHOT 150 is the slowest. And you might think, well, of course I want the fastest, right? Isn't faster better? And it is true that DSHOT 600 will have lower latency from the Flight Controller to the ESC than DSHOT 150. The disadvantage of the higher DSHOTs is that, well, if you go back far enough, some ESCs just didn't support the faster ones. That's not true anymore. Essentially, all modern ESCs support DSHOT 600 and even higher, although Betaflight doesn't go any higher than 600. But all ESCs can support DSHOT 600. The main reason that you might choose a slower one is if you have had to reduce your PID loop rate for some reason, which we'll talk about in another video, 8K PID loop DSHOT 600 is sort of the right one to choose because the latency of DSHOT 600 is similar to the latency of the 8K PID loop. If you're running a 4K PID loop, then DSHOT, there isn't a lot of benefit to using DSHOT 600, and you may as well use DSHOT 300. And if you went down to 2K, I suppose you would use DSHOT 150. So the DSHOT that you choose depends on your PID loop rate. The other thing to keep in mind is sometimes if your motor signals are getting corrupted, like your ESCs don't start up at the same time, you hear doo-doo-doo-doo-doo-doo-doo-doo-doo-doo-doo-doo, they're sort of out of sync, then dropping down from DSHOT 600 to 300 can make the signal a little bit more robust and solve that problem. But generally, you'll choose your DSHOT based on your PID loop rate. Continuing to work our way down here, motor stop. Normally, when you arm a freestyle quad or racing quad, the motors begin spinning immediately. That is not how camera platforms usually work. With camera platforms, the way it usually works is you arm the quad, and then when you raise the throttle, it starts the motors and begins to take off. If you want to emulate that behavior, you can enable motor stop, and then the quad will not spin the motors until you raise the throttle. Don't do this. If you're new to freestyle quads and racing quads, it may seem a little bit weird, but this is just how we do it. And the reason we do it this way is that when you're flying, quite a lot of the time with a freestyle and racing drone, you will drop the throttle all the way down to zero. And if you have motor stop enabled, when you do that, the quad will stop the motors and fall out of the air, and you'll lose control. With camera platforms, you don't do that. You've always got the throttle raised until the moment that you land. So don't use motor stop unless you're building a camera platform, in which case, why are you using Betaflight? Anyway, that's up to you. Now, though we're not talking about the configuration tab yet, there is one thing I need to show you, and that is if in the configuration tab you have air mode enabled, then motor stop will have no effect. It will still be here, but it will always be disabled. Air mode overrides motor stop. So if you're trying to get motor stop to work, and it's not having any effect, it may be because air mode is enabled. What's air mode? Well, we'll talk about that when we get to the configuration tab. ESC sensor. If you have an ESC that does BL-Heli32 ESC telemetry, ESC sensor tells the flight controller that that is going to be the case. And then when you enable ESC sensor, you also have the option here in the power and battery tab to choose ESC sensor as your current and your voltage meter source. So you can get battery voltage and current data from the ESC. There's a reason why I don't think this is useful for most people. I've got a video about why BL-Heli32 telemetry. I'm not too concerned about it. I'll put it down in the video description if you want to check it out. But if you are trying to use it, you will need to enable that option here in this tab. Next, we come to bidirectional D-shot. This is potentially one of the most important options you can enable in order to get the best flight performance out of your quadcopter. Bidirectional D-shot allows the ESC to send motor RPM back to the flight controller with extremely low latency. What that means is that the flight controller can filter out the motor RPM and get rid of that vibration or noise, as we say, very effectively. You absolutely want bidirectional D-shot if your ESC supports it. All BL-Heli32 ESCs from firmware 32.7 and newer support bidirectional D-shot, which any ESC you buy today, any BL-Heli32 ESC is going to support that. And BL-Heli S-ESCs don't support it, but there is a firmware called BlueJ you can flash to most BL-Heli S-ESCs that enables bidirectional D-shot, and I highly advise you to do that. I have a video about how to flash BlueJ, and I'll put it in the video description as well. You definitely want this enabled. If you enable bidirectional D-shot, then you're also going to see this motor poles option appear. In order for bidirectional D-shot and RPM filtering to work correctly, the flight controller needs to know how many magnets your motor has. The number is going to be 14 for typical 5-inch, 6-inch, 7-inch, and even a little bit smaller motors. But if you're uncertain, just literally pick the quad up, turn it over, rotate the motor in your hands, and count the magnets on the inside of the bell. Next, we come to the motor idle percent value. And this is the lowest throttle value that the flight controller will send to the motors. The idea is that if the throttle value sent to the motors is too low, the motor will stall and stutter, and if that happens in flight, the quad could fall out of the air. So you need to have a minimum idle value that keeps the motor moving, even under sort of adverse airflow conditions. The default for Betaflight, I believe, is 5.5%. You sometimes can go a little bit lower. Why would you want to go lower? Because the lower the idle value, like if you're inverted, and you have a high idle value, it will pull you down toward the ground. Whereas if you have a lower idle value, you can hang inverted for longer. A lower idle value also lets you drop faster. When you drop throttle, if you have a high idle value, you will float more and drop slower. Whereas with a lower idle value, you will drop faster. A higher idle value gives you better prop wash handling during turns. And the reason for that is that motors have more torque at higher throttle. So if you drop the throttle all the way down as low as it can possibly go, the motor won't have a lot of torque, and it will have a harder time dealing with difficult handling conditions like sharp turns. So some racers will actually turn this idle value up to 7 or 8%. Many freestyle pilots try and get it down as low as 2 or 3% so they get that nice hang time and clean drops. I don't recommend that you use this because Betaflight 4.3 has a setting called dynamic idle value. And if you use dynamic idle, it overrides the static idle value and works better. And we'll talk more about that when we get to the PID tuning tab. But that's what the idle percent is. The 3D option allows you to reverse the motors while you are in flight, allowing the quadcopter to fly upside down. And that's going to sound a little confusing if you've never heard of it. Basically what happens is that center throttle means that the motors are idled. And then if you raise the throttle, the quadcopter flies up. And if you lower the throttle below 50%, it pushes down. So you can literally flip the quad over and hover upside down or fly around upside down and lets you do all kinds of crazy acro stuff. If you enable this option, you have to also change the motor direction in BLHeli in the ESC. You can't just enable this option and leave your ESCs alone. It won't work. I have a video about setting up 3D and I'll link it down in the video description. I did it on a little tiny whoop so I didn't have much to lose. And it was pretty fun. Most people don't do this though. So if you've never heard of this, that's probably why. Now that we've set these options up, the motors are capable of spinning. But they won't spin until we change one of the other options on the page. Before I tell you what that is, could I ask you to go down and hit the like button? I'm sure it means a lot. Thank you. Okay. I understand the risks. The propellers are removed. Do you understand the risks? If we go and look over in the setup tab, we can see the MSP arming status flag. The MSP flag is telling us that stands for multi-way serial protocol. And it means that we are talking to the configurator and we cannot arm the quad. If we go to the motors tab and we enable this option, then when we go back to the setup tab, you will see that the MSP flag is gone. And now we can spin the motors. So your props better be off or you could get in trouble. Now, when I enable that option, these sliders are going to become enabled. But currently the sliders don't do anything. Those sliders are used to spin the motors. We have four motors, one, two, three, four. We can see where those motors are by looking at the mixer diagram. And we can raise these sliders and it shows the output value that the motor would be receiving. But it's not spinning because we don't have a battery plugged in. You can't spin the motors off of USB. You've got to plug a battery in. So let's do that. And now you can see that if I raise those sliders, the motors will begin to spin. Let me show you some shortcuts here for working with these sliders. If I click on the slider and then use the up arrow, it'll raise slowly, like one at a time. If I press page up and page down, it'll go up and down in increments. And if I do home and end, it'll go all the way to full and all the way to zero. You'd think home would take it all the way to full. Well, it looks like end takes it to full and home takes it to zero, which I'm pretty sure is backwards from how it used to be. But there you go. Don't do what I just did. Taking the throttle from zero all the way instantaneously to 100% is not great. I mean, it shouldn't hurt anything, but it's not great. And it's not a good... Don't do that if you can point it. Use page up and page down. So each of these sliders controls the individual motors, and then the master slider spins all four motors. As we're doing that, we can also see an error percent here. Now, that error percent only is visible if you're using bidirectional D-shot, because if you're not using bidirectional D-shot, the flight controller sends commands to the ESC, and then it has no idea if the ESC got them or if it didn't, just sends the commands and cross your fingers. So bidirectional D-shot is super useful for troubleshooting. As a rule of thumb, you want to see this error percent be less than 1%. Well, you want it to be 0%. It should almost always be 0%. But if it's slightly more than 0%, as long as it's less than 1%, you could fly and not consider yourself to have a serious problem. If any of these error percents are more than about 1%, something is wrong with your hardware, your signal wire, something is messed up, you should not fly the quad. And notice that it's 0% here, but, like, it might, if I had a problem with electrical noise, start having an issue when I start, like, arm the quad or something. But am I staying at 0% as you would hope. The other thing that we're seeing is the RPM of the motors. And that's what this R is here. And you can see that RPM is moving slightly as the motors have small differences in their speed. You might also be surprised that the motors aren't spinning at exactly the same RPM, given that they're getting the exact same throttle signal. And the reason for that is that there's small manufacturing variances in the motors. They are not exactly the same KV, and therefore sending them the same throttle signal produces small variances in RPM. In my experience, a difference in RPM of maybe 1 to 200 RPM is normal for, like, motors in this class. More than that could be an indication of a problem. In other words, if we raise the master slider, and we see that some of these motors are spinning at about 3,500 RPM, but then one of them is spinning at, like, 3,000 or 2,800 RPM, that motor might be screwed up. Now, I want to go back to this error percent, because I want you to see that if I unplug the battery, the error percent is going to go to 100%. If you see your error percent at 100% and your ESC is powered up, what it probably means is that your ESC doesn't support bidirectional D-shot. It could be that the flight controller is unplugged or something in theory. But most often, that's going to be a BL-Heli S ESC, which needs Blue Jay flash to it, and that's why you would see that. Now, you may be a little bit surprised to see this gyro readout scale here, and that's just showing me, as if I move the quad or tap the table, we can see a readout of the vibration that the quad is experiencing. Why is that on the motors tab? Because a good way to test for a bad motor, I told you you could look at the RPM. Another thing you can do is you can look at the vibration that the motor creates. So if I enable the slider here, what I'm going to do is I'm going to reset, and I'm going to look at the XYZ values. And what I'm seeing here is the max value in parentheses and the current value here on the left. And you can see the max value is about 0.98 Gs for all three of them. And then the RMS, the root mean square, is sort of the average for all three axes, and that's 0.4 roughly. What I'm then going to do is I'm going to raise the slider and bring it back down again. And I'm going to look at the amount of vibration that that motor created. And in fact, I have one of these motors that's been dinged up really badly. Yes, that's the one. That's motor number one. And that motor is in okay shape. And that was about 3.4, 2.2, and 1.7 Gs. If we then look at this banged up motor, which is motor number three, we should see a difference. So let's reset that. Bingo. Do you see that we have 6.1 on the Z axis, 2.9 and 1.46? So we've got significantly more vibration from that motor, and it's got visible damage, so I'm not surprised to see that. That's what that gyro scale is for. Lastly, let's come down to the motor direction and the reorder motors wizards. These are new in Betaflight 4.3, and they are so, so helpful. We're going to start with reorder motors. And the reason we might do this would be if the flight controller was not mounted facing forward or the ESC was rotated. If I hit reorder motors, the first thing I need to do is acknowledge the risk and then start the motor remapping wizard. The flight controller is going to spin one of the motors, and I'm going to click on whichever motor is spinning. Now, in this case, it's all correct because this quadcopter has been set up correctly. But if you had a case where an ESC was mounted, not mounted facing the expected direction or something like that, then this reorder motors wizard would sort it all out for you. And when you're done, you just hit save. The motor direction wizard does the same thing, but it checks for the motor spinning the correct direction. And there's two ways to do this. One is with the wizard, which will reset all of the motor spin directions and let you pick which one to reverse, or individually where it leaves the setting as it is and you check each motor individually. The key thing is that if you have previously set a quad up and you run the wizard, it will wipe your previous motor directions and set them all back to normal. So I normally do individually, and I just pick one motor, and I look at the direction it's spinning. Or sometimes if I can't tell, I'll just put my finger against it and see which way it's dragging. Okay, so that's dragging that way. So this one is spinning counterclockwise, counterclockwise, and that is correct. If we need to reverse it, we can just hit reverse here, and it will change the direction. And we can do that for all four of the motors to make sure they match the direction that we see here in the diagram. By the way, that motor reverse setting is stored in the ESC. So if you swap a flight controller, you do not need to redo that setting. It will be preserved. The motor direction will be preserved in the ESC. But if you swap an ESC, you would need to rerun that wizard. So to sum up, the general way that I go through this tab is, number one, set the mixer. Obviously, it's usually going to be quad X. Decide whether you want props in or props out rotation. Set your motor protocol. Enable bidirectional D-shot if at all possible. Check your motor poles are correct. Leave the motor idle alone because we're going to set that when we get to the PID tuning tab. We're not going to mess with that. And then run the reorder motors wizard to check the motor order. And then run the motor direction wizard to check the motor direction. And you're good. Next up, I think it's time to go to the configuration tab. We've waited long enough. I'm going to put a card on screen with a link to that video, as well as a card on screen with a link to the whole playlist for this series. If you want to start from the beginning and learn about all this stuff. Thanks so much for watching. I'll see you there.